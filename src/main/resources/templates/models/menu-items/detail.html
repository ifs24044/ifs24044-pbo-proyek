<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/base}"
  lang="id"
>
  <head>
    <title>Detail Menu</title>
    
    <!-- Custom CSS untuk Detail Page -->
    <th:block layout:fragment="others-css">
      <style>
        .detail-container {
          background: white;
          border-radius: 25px;
          box-shadow: 0 10px 40px rgba(0,0,0,0.08);
          overflow: hidden;
          margin-bottom: 30px;
        }

        /* Hero Section dengan Gradient */
        .detail-hero {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          padding: 2rem;
          position: relative;
          overflow: hidden;
        }

        .detail-hero::before {
          content: '';
          position: absolute;
          top: -50%;
          right: -10%;
          width: 400px;
          height: 400px;
          background: rgba(255,255,255,0.1);
          border-radius: 50%;
        }

        .detail-hero::after {
          content: '';
          position: absolute;
          bottom: -30%;
          left: -5%;
          width: 300px;
          height: 300px;
          background: rgba(255,255,255,0.08);
          border-radius: 50%;
        }

        .hero-content {
          position: relative;
          z-index: 1;
        }

        .back-btn-hero {
          background: rgba(255,255,255,0.2);
          color: white;
          border: 2px solid rgba(255,255,255,0.3);
          padding: 10px 25px;
          border-radius: 50px;
          transition: all 0.3s ease;
          backdrop-filter: blur(10px);
          font-weight: 600;
        }

        .back-btn-hero:hover {
          background: rgba(255,255,255,0.3);
          border-color: white;
          transform: translateX(-5px);
          color: white;
        }

        .menu-title {
          color: white;
          font-size: 2.5rem;
          font-weight: 700;
          margin: 1rem 0;
          text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .menu-subtitle {
          color: rgba(255,255,255,0.9);
          font-size: 1.1rem;
          margin-bottom: 1.5rem;
        }

        /* Image Section */
        .image-section {
          background: white;
          padding: 2rem;
          height: 100%;
          border-right: 1px solid #f0f0f0;
        }

        .image-container {
          position: relative;
          overflow: hidden;
          border-radius: 20px;
          height: 350px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.15);
          background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .image-container img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.5s ease;
        }

        .image-container:hover img {
          transform: scale(1.08);
        }

        .image-overlay {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
          padding: 1.5rem;
          opacity: 0;
          transition: opacity 0.3s ease;
        }

        .image-container:hover .image-overlay {
          opacity: 1;
        }

        .image-placeholder {
          display: flex;
          align-items: center;
          justify-content: center;
          height: 100%;
          color: #999;
          text-align: center;
        }

        .image-placeholder .emoji {
          font-size: 100px;
          margin-bottom: 20px;
          animation: float 3s ease-in-out infinite;
          filter: grayscale(0.3);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }

        .upload-btn {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          border: none;
          padding: 15px 30px;
          border-radius: 50px;
          font-weight: 600;
          transition: all 0.3s ease;
          width: 100%;
          margin-top: 20px;
          box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .upload-btn:hover {
          transform: translateY(-3px);
          box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
          color: white;
        }

        /* Info Cards */
        .info-section {
          padding: 2rem;
          background-color: #fff;
        }

        .info-card {
          background: #f8f9ff;
          border-radius: 15px;
          padding: 1.5rem;
          margin-bottom: 1.5rem;
          border-left: 4px solid #667eea;
          transition: all 0.3s ease;
        }

        .info-card:hover {
          background: #f0f4ff;
          transform: translateX(5px);
          box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .info-card-title {
          color: #667eea;
          font-weight: 700;
          font-size: 1.2rem;
          margin-bottom: 1rem;
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .info-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: 1.5rem;
        }

        .info-item {
          background: white;
          padding: 1rem;
          border-radius: 12px;
          transition: all 0.3s ease;
        }

        .info-item:hover {
          transform: translateY(-3px);
          box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .info-label {
          font-weight: 600;
          color: #666;
          display: flex;
          align-items: center;
          gap: 8px;
          margin-bottom: 8px;
          font-size: 0.9rem;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .info-value {
          color: #333;
          font-size: 1.3rem;
          font-weight: 700;
        }

        /* Price Section */
        .price-section {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          padding: 2rem;
          border-radius: 20px;
          text-align: center;
          margin-bottom: 1.5rem;
          position: relative;
          overflow: hidden;
        }

        .price-section::before {
          content: '';
          position: absolute;
          top: -50%;
          right: -10%;
          width: 200px;
          height: 200px;
          background: rgba(255,255,255,0.1);
          border-radius: 50%;
        }

        .price-label {
          color: rgba(255,255,255,0.9);
          font-size: 1rem;
          margin-bottom: 0.5rem;
          position: relative;
          z-index: 1;
        }

        .price-value {
          color: white;
          font-size: 3rem;
          font-weight: 800;
          text-shadow: 0 4px 15px rgba(0,0,0,0.2);
          position: relative;
          z-index: 1;
        }

        /* Status Badges */
        .badge-custom {
          padding: 12px 25px;
          border-radius: 50px;
          font-weight: 600;
          font-size: 1rem;
          display: inline-flex;
          align-items: center;
          gap: 8px;
          box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }
        .badge-available { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; }
        .badge-unavailable { background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; }
        .badge-category { background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; }

        /* Description Card (Dipindahkan Style-nya sedikit untuk di kiri) */
        .description-card {
          background: #f8f9ff; /* Menyesuaikan style card info */
          border-radius: 15px;
          padding: 1.5rem;
          margin-top: 1.5rem; /* Jarak dari tombol upload */
          border-left: 4px solid #667eea;
          line-height: 1.8;
          color: #555;
        }

        /* Timestamp Section */
        .timestamp-section {
          background: #f8f9fa;
          border-radius: 15px;
          padding: 1.5rem;
          display: flex;
          justify-content: space-between;
          gap: 2rem;
        }

        .timestamp-item {
          flex: 1;
          text-align: center;
        }

        .timestamp-label {
          color: #666;
          font-size: 0.9rem;
          margin-bottom: 0.5rem;
          display: block;
        }

        .timestamp-value {
          color: #333;
          font-weight: 600;
          font-size: 1rem;
        }

        /* Responsive */
        @media (max-width: 991px) {
            .image-section { border-right: none; border-bottom: 1px solid #f0f0f0; }
        }
      </style>
    </th:block>
  </head>
  
  <body>
    <div layout:fragment="content" class="container mt-4 mb-5">
      
      <!-- Main Detail Container -->
      <div class="detail-container">
        
        <!-- Hero Section -->
        <div class="detail-hero">
          <div class="hero-content">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <a th:href="@{/}" class="btn back-btn-hero">
                ‚Üê Kembali ke Menu
              </a>
              <div class="d-flex gap-2">
                <span class="badge-custom badge-category">
                  <span th:text="${menuItem.category != null ? menuItem.category : 'No Category'}">Category</span>
                </span>
                <span th:if="${menuItem.isAvailable}" class="badge-custom badge-available">
                  ‚úÖ Tersedia
                </span>
                <span th:unless="${menuItem.isAvailable}" class="badge-custom badge-unavailable">
                  ‚ùå Habis
                </span>
              </div>
            </div>
            
            <h1 class="menu-title" th:text="${menuItem.name}">Nama Menu</h1>
            <p class="menu-subtitle">üçΩÔ∏è Detail lengkap menu restoran Anda</p>
          </div>
        </div>

        <!-- Content Grid -->
        <div class="row g-0">
          
          <!-- KOLOM KIRI: Gambar, Upload, & Deskripsi -->
          <div class="col-lg-5">
            <div class="image-section">
              
              <!-- 1. Gambar -->
              <div class="image-container">
                <img th:if="${menuItem.imageUrl != null and menuItem.imageUrl != ''}"
                     th:src="@{/menu-items/image/{filename}(filename=${menuItem.imageUrl})}" 
                     th:alt="${menuItem.name}"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                
                
                
                <div class="image-placeholder" 
                     th:style="${menuItem.imageUrl != null and menuItem.imageUrl != '' ? 'display:none;' : 'display:flex;'}">
                  <div>
                    <div class="emoji">üçΩÔ∏è</div>
                    <h4 style="color: #999;">Belum Ada Gambar</h4>
                    <p class="mb-0" style="color: #aaa;">Upload foto menu yang menarik</p>
                  </div>
                </div>
              </div>
              
              <!-- 2. Tombol Upload -->
              <button class="upload-btn" data-bs-toggle="modal" data-bs-target="#editMenuImageModal">
                üì∑ Upload/Ganti Gambar Menu
              </button>

              <!-- 3. Deskripsi Menu (DIPINDAHKAN KE SINI) -->
              <div class="description-card">
                <div class="info-card-title">
                  üìù Deskripsi Menu
                </div>
                <div>
                  <p class="mb-0" th:text="${menuItem.description != null and menuItem.description != '' ? menuItem.description : 'Tidak ada deskripsi untuk menu ini.'}">
                    Tidak ada deskripsi
                  </p>
                </div>
              </div>

            </div>
          </div>

          <!-- KOLOM KANAN: Harga, Info Waktu/Kalori, Timestamp -->
          <div class="col-lg-7">
            <div class="info-section">
              
              <!-- 1. Harga -->
              <div class="price-section">
                <div class="price-label">üí∞ Harga Menu</div>
                <div class="price-value">
                  <span th:if="${menuItem.price != null}"
                        th:text="'Rp ' + ${#numbers.formatDecimal(menuItem.price, 0, 'COMMA', 0, 'POINT')}">
                    Rp 0
                  </span>
                  <span th:unless="${menuItem.price != null}">Rp 0</span>
                </div>
              </div>

              <!-- 2. Informasi Menu (Waktu & Kalori) -->
              <div class="info-card">
                <div class="info-card-title">
                  üìä Informasi Menu
                </div>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">‚è±Ô∏è Waktu Siap</span>
                    <div class="info-value">
                      <span th:if="${menuItem.preparationTime != null}"
                            th:text="${menuItem.preparationTime} + ' menit'">0 menit</span>
                      <span th:unless="${menuItem.preparationTime != null}" style="color: #999;">-</span>
                    </div>
                  </div>
                  
                  <div class="info-item">
                    <span class="info-label">üî• Kalori</span>
                    <div class="info-value">
                      <span th:if="${menuItem.calories != null}" 
                            th:text="${menuItem.calories} + ' kcal'">0 kcal</span>
                      <span th:unless="${menuItem.calories != null}" style="color: #999;">-</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 3. Timestamp -->
              <div class="timestamp-section">
                <div class="timestamp-item">
                  <span class="timestamp-label">üìÖ Dibuat Pada</span>
                  <div class="timestamp-value">
                    <span th:if="${menuItem.createdAt != null}"
                          th:text="${#temporals.format(menuItem.createdAt, 'd MMM yyyy')}">-</span>
                    <span th:unless="${menuItem.createdAt != null}">-</span>
                  </div>
                  <small class="text-muted">
                    <span th:if="${menuItem.createdAt != null}"
                          th:text="${#temporals.format(menuItem.createdAt, 'HH:mm')}"></span>
                  </small>
                </div>
                
                <div class="timestamp-item">
                  <span class="timestamp-label">üîÑ Terakhir Update</span>
                  <div class="timestamp-value">
                    <span th:if="${menuItem.updatedAt != null}"
                          th:text="${#temporals.format(menuItem.updatedAt, 'd MMM yyyy')}">-</span>
                    <span th:unless="${menuItem.updatedAt != null}">-</span>
                  </div>
                  <small class="text-muted">
                    <span th:if="${menuItem.updatedAt != null}"
                          th:text="${#temporals.format(menuItem.updatedAt, 'HH:mm')}"></span>
                  </small>
                </div>
              </div>

            </div>
          </div>
        </div>

      </div>

      <!-- Modal Upload Image -->
      <div th:replace="~{pages/menu-items/edit-image :: editMenuImageModal}"></div>
    </div>

    <!-- Custom JavaScript -->
    <th:block layout:fragment="others-js">
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          // Auto-open modal jika ada error upload
          var editMenuImageModalOpen = "[[${editMenuImageModalOpen}]]" === "true";
          if (editMenuImageModalOpen) {
            var editModal = new bootstrap.Modal(document.getElementById("editMenuImageModal"));
            editModal.show();
          }
          
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      </script>
    </th:block>
  </body>
</html>